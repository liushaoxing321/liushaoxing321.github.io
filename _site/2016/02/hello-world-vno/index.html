<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Autolayout</title>
  <meta name="description" content="Autolayout 基础">
  <meta name="author" content="Wei Wang">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Autolayout">
  <meta name="twitter:description" content="Autolayout 基础">
  
  <meta property="og:type" content="article">
  <meta property="og:title" content="Autolayout">
  <meta property="og:description" content="Autolayout 基础">
  
  <link rel="icon" type="image/png" href="/assets/images/favicon.png" />
  <link href="/assets/images/favicon.png" rel="shortcut icon" type="image/png">
  
  <link rel="stylesheet" href="/css/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="canonical" href="http://liushaoxing.github.io/2016/02/hello-world-vno/">
  <link rel="alternate" type="application/rss+xml" title="刘少星'S Home" href="http://liushaoxing.github.io/feed.xml">
  
  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />
  
</head>


  <body>

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    
    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/assets/images/background-cover.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/#blog" title="前往 刘少星'S Home 的主页" class="blog-button"><img src="/assets/images/avatar.jpg" width="80" alt="刘少星'S Home logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/#blog" title="link to homepage for 刘少星'S Home" class="blog-button">刘少星'S Home</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">人一切的痛苦本质上都是对自己无能的愤怒</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">我叫刘少星(一名北漂3年的iOS开发工程师)</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        
        <p class="panel-cover__description">欢迎来到我的博客</p>
        
        
        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="Visit blog" class="blog-button">Blog</a></li>
                
              </ul>
            </nav>
          </div>
          
          <div><nav class="cover-navigation navigation--social">
  <ul class="navigation">

  
  <!-- Weibo -->
  <li class="navigation__item">
    <a href="http://weibo.com/liushaoxing321@163.com" title="@liushaoxing321@163.com 的微博" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li>
  

  
  <!-- Github -->
  <li class="navigation__item">
    <a href="https://github.com/https://www.github.com/liushaoxing321" title="@https://www.github.com/liushaoxing321 的 Github" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>
  
  
  
  <!-- Twitter -->
  <li class="navigation__item">
    <a href="http://twitter.com/liu_shaoxing@163.com" title="@liu_shaoxing@163.com" target="_blank">
      <i class='social fa fa-twitter'></i>
      <span class="label">Twitter</span>
    </a>
  </li>
  

  
  <!-- Google Plus -->
  <li class="navigation__item">
    <a href="https://plus.google.com/107108267983477358170" rel="author" title="Google+" target="_blank">
      <i class='social fa fa-google-plus-square'></i>
      <span class="label">Google Plus</span>
    </a>
  </li>
  

  <!-- RSS -->
  <li class="navigation__item">
    <a href="/feed.xml/" rel="author" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>

  
  <!-- Email -->
  <li class="navigation__item">
    <a href="mailto:liu_shaoxing@163.com" title="Contact me">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>
  

  </ul>
</nav>
</div>
        </div>
      </div>
    </div>
    
    
    <div class="panel-cover--overlay cover-red"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="2016-02-16 14:32:24 +0800" itemprop="datePublished" class="post-meta__date date">2016-02-16</time> &#8226; <span class="post-meta__tags tags"></span>
    </div>
    <h1 class="post-title">Autolayout</h1>
  </header>

  <section class="post">
    <h1>Autolayout 基础</h1>

<p><code>Archives</code> <code>iOS</code></p>

<hr>

<p><em>如果您觉得我的博客对您有帮助，请通过关注我的新浪微博 <a href="http://weibo.com/1736763114/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo">MicroCai</a> 支持我，谢谢！</em></p>

<hr>

<p>这两天自学的时候，复习了下 autolayout。本来想来写一篇文章记录下学习内容，搜了一下写的人真不少，也写得挺不错的。照理我就不用写了，但心里总有那么一点点遗憾，这么流行的东西，我博客里怎么能没有呢？既然如此，那就多写点基础内容。</p>

<p>警告：博主为博文贴了十几张图片，查克拉耗尽，生命垂危，关注 <a href="http://weibo.com/1736763114/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo">MicroCai</a> 或者送香吻一个就能唤醒博主，好人一生平安。</p>

<div class="toc">

<div class="toc">

*   [Autolayout 基础](#autolayout-基础)
    *   [Interface Builder 介绍](#interface-builder-介绍)
        *   [Align（对齐）](#align对齐)
        *   [Pin：设置相对大小和位置](#pin设置相对大小和位置)
        *   [Resolve Auto Layout Issues：解决 autolayout 问题](#resolve-auto-layout-issues解决-autolayout-问题)
        *   [Resizing Behavior](#resizing-behavior)
        *   [SizeClass](#sizeclass)
            *   [重写布局](#重写布局)
            *   [使用 Xcode 6 预览](#使用-xcode-6-预览)
    *   [VFL（Visual Format Language）](#vflvisual-format-language)
    *   [Autolayout 常见问题](#autolayout-常见问题)
    *   [Masonry：替代 Autolayout](#masonry替代-autolayout)

</div>

<p></div></p>

<h2>Interface Builder 介绍</h2>

<p>在 storyboard 界面的右下角，有这么一排图标</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_1.png" alt=""></p>

<p>鼠标放上去停留一小段时间，就会告诉你它们的作用，从左至右依次是：</p>

<ul>
<li>  Align：用来设置对齐相关的约束；</li>
<li>  Pin：设置相对大小和位置；</li>
<li>  Resolve Auto Layout Issues：解决 autolayout 问题；</li>
<li>  Resizing Behavior：设置重置大小会如何影响其他对象；</li>
</ul>

<h3>Align（对齐）</h3>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_2.png" alt=""></p>

<p>下面这些是两个视图层次中同一级的 View 的对齐。</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">Leading Edges：头对齐
Trailing Edges：尾对齐
Top Edges：顶部对齐
Bottom Edges：底部对齐

Horizontal Centers：水平中心对齐
Vertical Centers：垂直中心对齐
BaseLines：基准线（默认 View 底部位置）水平对齐，用来对齐有文字的控件，如 UILabel、UIButton 等
</code></pre></figure>
<p>下面这些是 SuperView 和 SubView 的对齐，SuperView 是 SubView 的 Container</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">Horizontal Center in Container：View 的水平中心和容器的水平中心的相对距离
Vertical Center in Container：View 的垂直中心和容器的垂直中心的相对距离
</code></pre></figure>
<p>在对齐数值的白色输入框内，点击右侧下拉框可以选择“Use Current Canvas Value”，意思是使用当前 Xib/Storyboard 内的差值。</p>

<p>最后一个 Update Frames 表示如何更新 frame，有三个选项，默认为 None 不更新</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">None：不更新 frame
Items of New Constraints：更新新添加的 frame
All Frames in Container：更新容器内所有的 frame
</code></pre></figure>
<h3>Pin：设置相对大小和位置</h3>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_3.png" alt=""></p>

<p>最上面有四个矩形框和四条虚线，原来用过 auto resizing 的童鞋应该会比较眼熟。矩形框里的数字表示当前的 View 到最近的 View （注意：不是 SuperView）边缘的距离。</p>

<p>在矩形框下面有一行灰色字的可选项“Constrain to margins”，意思是在设置上述约束是相对于 margins 设置的，而 margin 默认距离是 16。如和上边缘距离 306，加上 16，所以 View 的顶部和它上边最近的 View 的距离是 312。</p>

<p>其他的选项</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">Width：设置宽度
Height：设置高度

Equal Widths：设置两个同级 View 的宽度关系
Equal Heights：设置两个同级 View 的高度关系
Aspect Ratio：设置 View 自身宽高比例

Align：和前面所讲的 **Align** 一致。那为什么 **Align** 还会出现在这边呢？估计和 **Pin** 有关系，故而也放到这边。
</code></pre></figure>
<h3>Resolve Auto Layout Issues：解决 autolayout 问题</h3>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_4.png" alt=""></p>

<p>可以选择要处理的 Views：当前选中的 Views 或 Controller 内所有的 Views</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">Update Frames：更新 frame 
Update Constraints：更新约束
Add Missing Constraints：添加遗漏的约束
Reset to Suggested Constraints：重置约束
Clear Constraints：清除约束
</code></pre></figure>
<h3>Resizing Behavior</h3>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_5.png" alt=""></p>

<p>设置重置大小会如何影响其他对象，有两个选项（默认已勾选）</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">Sublings and Ancestors：影响同级兄弟 Views 和祖先 Views
Descendants：影响后代 Views
</code></pre></figure>
<p><em>（这个地方我也没弄明白，我查了文档和一些博客，都只是做了简单文字说明，然后自己试了下勾选和未勾选的情况，还是找不到有什么区别，所以也没明白具体是如何影响。）</em></p>

<h3>SizeClass</h3>

<p>SizeClass 中文意思可以理解为尺寸等级，就是在 autolayout 的基础上，加上屏幕尺寸类型的定义。SizeClass 的宽高有三种类型：Compact（紧凑）、Any（任意）、Regular（普通）</p>

<p><em>不同设备屏幕的宽高类型</em><br>
<img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_6.png" alt=""></p>

<p>当你具体选择尺寸时， IB 会显示出当前选择的屏幕尺寸的相关信息，如宽高类型，屏幕尺寸类型，这个尺寸适用于哪些设备等。</p>

<h4>重写布局</h4>

<p>如果你设置的某种类型屏幕的约束布局，在其他类型屏幕下出现不符合意图的布局时，可以重写布局，即重新设置该屏幕类型下的布局。</p>

<p>如图的 UIView 设置了 wAny|hAny 上下左右四个约束</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_7.png" alt=""></p>

<p>点击这个 UIView，查看 Attribute Inspector 有个 install 选项被勾选上了。</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_8.png" alt=""></p>

<p>Installed/UnInstalled 表示的意思是当前布局是否被安装在什么类型的屏幕上。Installed/UnInstalled 前面如果没有东西，表示布局是安装在 wAny|hAny 类型的屏幕上。现在如果我们要单独设置某种类型屏幕的布局可以点击加号，选择屏幕类型</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_9.png" alt=""></p>

<p>将新的屏幕类型的勾选取消掉，则当前布局在该类型下不起作用，此时就可以切换类型，重新设置所有约束。</p>

<p>若只想修改一条约束，也可以点击 Size Inspector</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_10.png" alt=""></p>

<p>选择 Constraints —— All 显示所有约束，双击任意一条约束，会出现一个和之前类似的界面</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_11.png" alt=""></p>

<p>Installed 前面也有个加号，估计你也该猜到了，这里的修改和之前也是类似的。</p>

<p>如果 Xcode 的 Inspector 一些选项前面有加号，就表明它可以被重写，比如刚刚这幅图中，Installed<br>
选项上方的 Constant 前面也有加号，说明它也是可以被重写的。类似的还有 UILabel 的 font，<strong>但是</strong>：与重写布局不同，在不同的 size class 中改变文字的属性始终会影响基础布局中的文字。它不能像布局一样，在不同的size class中设置不同的属性值。我们通过下面的方法来解决这一问题。 <a href="http://www.devtalking.com/articles/adaptive-layout-2/">参考：Swift自适应布局（Adaptive Layout）教程（二）</a>。</p>

<h4>使用 Xcode 6 预览</h4>

<p>在屏幕类型多了这么多之后，做不同类型的屏幕适配也是需要花不少功夫。如果每次适配一种类型屏幕后，都要运行后才能查看效果，效率简直太低下了。Xcode 6 提供了 preview 预览功能，针对这个问题可以节省不少时间。</p>

<p>点击 Xcode Tool Bar 的 Assistant Editor 按钮，显示另一个窗口</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_12.png" alt=""></p>

<p>选择 Preview 展示预览界面</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_13.png" alt=""></p>

<p>如果想在预览中同时显示不同类型的屏幕，可以在预览界面的左下角点击加号，选择更多设备</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_14.png" alt=""></p>

<p>如果想要查看横屏/竖屏，点击设备下方的旋转按钮即可</p>

<p><img src="http://blogofzuoyebuluo.qiniudn.com/image_note73867_15.png" alt=""></p>

<h2>VFL（Visual Format Language）</h2>

<p>不得不说，VFL 的语法比手写 Constraints 的量少了很多，也有象形文字的感觉，但是和普通的 Swift 语法风格比起来实在不搭调。这个内容直接看 <a href="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/AutolayoutPG/VisualFormatLanguage/VisualFormatLanguage.html">官方文档</a> 吧，都用图表示出来，说明的挺清楚的。</p>

<h2>Autolayout 常见问题</h2>

<ol>
<li><p><em>设置了 autolayout 之后，在代码中还能用 self.someView.frame 修改 frame 吗？</em><br>
不能</p></li>
<li><p><em>为什么有些控件只设置 x、y 值约束，也不会出错？</em><br>
UIKit 的一些控件如 UILabel、UIImageView 等有自适应特性，会根据内容自适应尺寸，所以不需要再约束其宽高。</p></li>
<li><p><em>同样的约束用在 UIScrollView 和 UIImageViwe 上，为什么会出现错误？</em><br>
参考 <a href="http://nonomori.farbox.com/post/scrollview-yu-autolayout">Nonomori 的文章：ScrollView 与 Autolayout</a></p></li>
</ol>

<h2>Masonry：替代 Autolayout</h2>

<p>Masonry 是目前为止公认的 autolayout 最好的替代方案，语法简洁、直观，不会出现各种意外之外的布局。根据网上了解到的一些情况，Masonry 在大型项目中的效果比 autolayout 好很多。</p>

  </section>
</article>

<section class="read-more">
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">最近的文章</span>
       <h2 class="post-list__post-title post-title"><a href="/2016/03/about-myself/" title="link to iOS开发工程师个人简历">iOS开发工程师个人简历</a></h2>
       <p class="excerpt">前言&#160; &#160; &#160; &#160;欢迎您来到我的个人博客,因为智联等一些招聘网站简历的排版不忍直视,所以用自己的博客发了一篇个人简历。同时感谢您抽出宝贵时间来查看我的简历,我很期待能有跟您面谈的机会.基本信息&#160; &#160; &#160; &#160; &#160; &#160; &#160;姓名:刘少星 &#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &...&hellip;</p>
       <div class="post-list__meta"><time datetime="2016-03-14 00:00:00 +0800" class="post-list__meta--date date">2016-03-14</time> &#8226; <span class="post-list__meta--tags tags">iOS</span><a class="btn-border-small" href=/2016/03/about-myself/>继续阅读</a></div>
   </div>
   
   
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">更早的文章</span>
       <h2 class="post-list__post-title post-title"><a href="/2016/02/sample-post/" title="link to NSRunLoop">NSRunLoop</a></h2>
       <p class="excerpt">前言做了一年多的IOS开发，对IOS和Objective-C深层次的了解还十分有限，大多还停留在会用API的级别，这是件挺可悲的事情。想学好一门语言还是需要深层次的了解它，这样才能在使用的时候得心应手，出现各种怪异的问题时不至于不知所措。废话少说，进入今天的正题。不知道大家有没有想过这个问题，一个应用开始运行以后放在那里，如果不对它进行任何操作，这个应用就像静止了一样，不会自发的有任何动作发生，但是如果我们点击界面上的一个按钮，这个时候就会有对应的按钮响应事件发生。给我们的感觉就像应用一直...&hellip;</p>
       <div class="post-list__meta"><time datetime="2016-02-15 14:32:24 +0800" class="post-list__meta--date date">2016-02-15</time> &#8226; <span class="post-list__meta--tags tags"></span><a class="btn-border-small" href=/2016/02/sample-post/>继续阅读</a></div>
   </div>
   
</section>

<!-- <section class="post-comments">
  
    <div id="disqus_thread"></div>
    <script>
    
    var disqus_config = function () {
        this.page.url = "http://liushaoxing.github.io/2016/02/hello-world-vno/";
        this.page.identifier = "/2016/02/hello-world-vno/";
    };

    var disqus_shortname = 'vno-jekyll';
    
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>要查看<a href="http://disqus.com/?ref_noscript"> Disqus </a>评论，请启用 JavaScript</noscript>
    
  
  
  
  
</section>
 -->

            <section class="footer">
    <footer>
    	<span class="footer__copyright">本站点采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享 署名-非商业性使用-相同方式共享 4.0 国际 许可协议</a></span>
        <span class="footer__copyright">由 <a href="https://jekyllrb.com">Jekyll</a> 于 2016-03-14 生成，感谢 <a href="https://www.digitalocean.com/?refcode=30ed2d146762">Digital Ocean</a> 为本站提供稳定的 VPS 服务</span>
        <span class="footer__copyright">本站由 <a href="http://onev.cat">@onevcat</a> 创建，采用 <a href="https://github.com/onevcat/vno-jekyll">Vno - Jekyll</a> 作为主题，您可以在 GitHub 找到<a href="https://github.com/onevcat/OneV-s-Den">本站源码</a> - &copy; 2016</span>
    </footer>
</section>

        </div>
    </div>
    
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<script type="text/javascript" src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript" src="/js/main.js"></script>



    
  </body>

</html>
